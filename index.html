<html>

<head>
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/white.css">
    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
</head>

<body>
    <div class="reveal">
        <div class="slides">
            <section>
                <h3>@Mikhail.Angelov</h3>
                <div>

                    <span class="logo"><img id='tt' src="tt.png"/></span>
                </div>
                <div>
                    <span class="logo">Ѣ</span>
                </div>
            </section>
            <section>

                <h2>Генераторы в</h2>
                <h3>java-script</h3>

                <img id='gen' style='width:600px; border:0;box-shadow: 0 0 0;' src="generator.jpg" />

            </section>
            <!--                 <section class='second'>
                    
                    <p class="quote">Будь проще и люди к тебе потянутся</p>


                    <div class="quote-author">TBD</div>
                    <img id="rabbit" src="rabbit.gif">
                </section> -->

            <section>
                <p>Так может выглядеть ассинхронный код на callback</p>
                <pre><code data-trim="" data-noescape="" class="javascript" style="max-height: 600px; font-size: 20px; line-height: 100%;">
function createUser(req, res){
    checkParams(req.body, (err, result)=>{
        if(err){
            res.status(400).send(err)
        }else{
            createUser(req.body, (err, user)=>{
                if(err){
                    res.status(400).send(err)
                }else if(user.isNew){
                    sendWelomeMail(user, (err)=>{
                        res.json(user)
                    })
                }else{
                    res.json(user)
                }
            })
        }
    })
}

                </code></pre>
            </section>
            <section>
                <p>Так может выглядеть ассинхронный код на promise</p>
                <pre><code data-trim="" data-noescape="" class="javascript" style="max-height: 600px; font-size: 20px; line-height: 100%;">
function createUser(req, res){
    checkParams(req.body)
        .then(()=>createUser(req.body))
        .then(user=>{
            if(user.isNew){
                return sendWelomeMail(user)
                    .then(()=>res.json(user))
                })
            }else{
                res.json(user)
            }
        })
        .catch(err=>res.status(400).send(err))
}

                </code></pre>
            </section>
            <section>
                <p>Так может выглядеть ассинхронный код на generators</p>
                <pre><code data-trim="" data-noescape="" class="javascript" style="max-height: 600px; font-size: 20px; line-height: 100%;">
function createUser(req, res){
    co(function*(){
        yield checkParams(req.body)
        const user = yield createUser(req.body)
        if(user.isNew){
            yield sendWelomeMail(user)
        }
        res.json(user)
    }).catch(err=>res.status(400).send(err))
}
                </code></pre>
            </section>

            <section>
                <p>Генераторы это особый тип функций которые позволяют выйти и войти в них в определенной точке исполнения
                    обозначенной ключевым словом <b>yield</b> при этом сохраняется контекст исполения этой функции
                </p>
            </section>

            <section>
                <p>Управление последовательностью выполнения инструкций</p>
                <pre><code data-trim="" data-noescape="" class="javascript" style="max-height: 600px; font-size: 20px; line-height: 100%;">
function* gena(){
    console.log('start generator') //3
    yield 'hi'                     //4
    console.log('next step')       //7
}
const g = gena(); //1
var a = g.next(); //2 ... //5 a={ value: 'hi', done: false }
a = g.next();     //6 ... //8 a={ value: undefined, done: true }
                </code></pre>
            </section>
            <section>
                <p>Наивная имплементация co</p>
                <pre><code data-trim="" data-noescape="" class="javascript" style="max-height: 600px; font-size: 20px; line-height: 100%;">
function co(generagtor) {
    return new Promise((resolve, reject) => {
        const gen = generagtor()
        next(gen.next())

        function next(response) {
            if (response.done) {
                resolve(response.value)
            } else {
                response.value
                    .then(data => next(gen.next(data)))
                    .catch(err=>reject(err))
            }
        }
    })
}
                </code></pre>
            </section>
            <!--<section>

                <p class="ciu_embed" data-feature="async-functions" data-periods="future_1,current,past_1">
                    <a href="http://caniuse.com/#feat=async-functions&feature_sort=usr_score">Can I Use async-functions?</a>                    Data on support for the async-functions feature across the major browsers from caniuse.com.
                </p>

            </section>-->


            <section data-state="customevent">
                <p>
                    Спасибо за внимание!
                </p>
                <p>
                    <a href="https://mikhail-angelov.github.io/presentation-generators/#/">https://mikhail-angelov.github.io/presentation-generators/</a>
                </p>


            </section>
        </div>
    </div>
    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script src="http://cdn.jsdelivr.net/caniuse-embed/1.0.1/caniuse-embed.min.js"></script>
    <script>
        Reveal.initialize({
            history: true,

            // More info https://github.com/hakimel/reveal.js#dependencies
            dependencies: [
                { src: 'plugin/markdown/marked.js' },
                { src: 'plugin/markdown/markdown.js' },
                { src: 'plugin/notes/notes.js', async: true },
                { src: 'plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } }
            ],
            width: 1000,
            height: 600,

            // Factor of the display size that should remain empty around the content
            margin: 0.1,

            // Bounds for smallest/largest possible scale to apply to content
            minScale: 1.0,
            maxScale: 1.5
        });
    </script>
</body>

</html>